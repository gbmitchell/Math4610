# Math 4610 Fundamentals of Computational Mathematics
Homework 2, problem 4.

**Routine Name:**           fixed1, fixed2

**Author:** Gary Mitchell

**Language:** C. The code can be compiled using the Microsoft Visual C compiler.

For example,

    approximation.c

will produce an executable **approximation.exe** that can be executed.

**Description/Purpose:** These functions will compute an approximation for a root of a defined
function f(x) given an initial guess for the value of x. The function fixed1 takes the form of
g(x) = x + f(x) and the function fixed2 takes the form g(x) = x - f(x). These can then be used
for itteratoin g(Xn+1) = Xn + f(Xn) or g(Xn+1) = Xn - f(Xn) to approximate the root of a defined
function f(x). Where xr is the root, g'(xr) must be less than 1 in order for the itteration to
converge. 

**Input:** There are five inputs needed in these cases. A defined function f(x), an initial guess
for the root (initialGuess), a tolerance (eps), a maximum amount of times to itterate (maxIteration),
and the expected value of the root (exproot) to calculate the error for analizing the fixed itteration
functions.

**Output:** The functions return a double precision value that represents an approximation for the
root of a defined function f(x) given an initial guess for the root.

**Usage/Example:**

The functions return an approximation for the root of a defined function f(x) given an initial guess for
the root. The goal is to find a function g(x) = x and recursivly itterate the function until an approximate
root is found within an acceptable tolerance. The code below uses two defined functions, f(x) = x^2 - 3 and
f(x) = sin(Pi * x) as functions to find the roots of. To find the funcion g(x) = x, the function f(x) is set
equal to zero and either add or subtract x to both sides of the equation. The result is an equation in the
form of g(Xn+1) = Xn + f(Xn) that can be itterated until g(Xn+1) is approximatly equal to the expected root.
To meet the requirement of g'(xr) less than 1, the initial functions for f(x) were divided by 10.

	#include <stdio.h>
	#include <math.h>
	#include <mylib.h>

	int main() {

		int ipow = 0;
		int  maxIteration = 0;
		double eps = 0.0;
		double root = 0.0;
		double exproot = 0.0;
		double initialGuess = 0.0;

		//***************************************************************************************
		//************ root finding fixed point iteration for x^2 - 3 ***************************
		//***************************************************************************************
		initialGuess = 2;
		maxIteration = 85;
		exproot = 1.73205080757;
		dmaceps(&eps, &ipow);

		root = fixed2(fnct8, initialGuess, eps, maxIteration, exproot);


		//*****************************************************************************************
		//**************** root finding fixed point iteration for sin(Pi*x)  **********************
		//*****************************************************************************************
		dmaceps(&eps, &ipow);
		initialGuess = 0.5;
		maxIteration = 100;
		exproot = 1.0;

		root = fixed1(fnct9, initialGuess, eps, maxIteration, exproot);
	}

Output from the lines above:

	fixed point approximation for f(x) = ( x^2 - 3 ), where g(x) = x - ( f(x)/10 )
	dmaceps =  1.11022302e-16
	Initial value = 2.000000
	expected root = 1.73205081
	
	i       | Xn                    | Xn+1                  | e absolute    | e relative
	--------------------------------------------------------------------------------------------
	1       | 2.00000000e+00        | 1.90000000e+00        | 1.679e-01     | 9.697e-02
	2       | 1.90000000e+00        | 1.83900000e+00        | 1.069e-01     | 6.175e-02
	3       | 1.83900000e+00        | 1.80080790e+00        | 6.876e-02     | 3.970e-02
	4       | 1.80080790e+00        | 1.77651699e+00        | 4.447e-02     | 2.567e-02
	5       | 1.77651699e+00        | 1.76091573e+00        | 2.886e-02     | 1.667e-02
	6       | 1.76091573e+00        | 1.75083331e+00        | 1.878e-02     | 1.084e-02
	7       | 1.75083331e+00        | 1.74429158e+00        | 1.224e-02     | 7.067e-03
	8       | 1.74429158e+00        | 1.74003627e+00        | 7.985e-03     | 4.610e-03
	9       | 1.74003627e+00        | 1.73726365e+00        | 5.213e-03     | 3.010e-03
	10      | 1.73726365e+00        | 1.73545515e+00        | 3.404e-03     | 1.965e-03
	11      | 1.73545515e+00        | 1.73427469e+00        | 2.224e-03     | 1.284e-03
	12      | 1.73427469e+00        | 1.73350382e+00        | 1.453e-03     | 8.389e-04
	13      | 1.73350382e+00        | 1.73300027e+00        | 9.495e-04     | 5.482e-04
	14      | 1.73300027e+00        | 1.73267128e+00        | 6.205e-04     | 3.582e-04
	15      | 1.73267128e+00        | 1.73245630e+00        | 4.055e-04     | 2.341e-04
	16      | 1.73245630e+00        | 1.73231582e+00        | 2.650e-04     | 1.530e-04
	17      | 1.73231582e+00        | 1.73222401e+00        | 1.732e-04     | 1.000e-04
	18      | 1.73222401e+00        | 1.73216401e+00        | 1.132e-04     | 6.536e-05
	19      | 1.73216401e+00        | 1.73212479e+00        | 7.398e-05     | 4.272e-05
	20      | 1.73212479e+00        | 1.73209916e+00        | 4.836e-05     | 2.792e-05
	21      | 1.73209916e+00        | 1.73208241e+00        | 3.160e-05     | 1.825e-05
	22      | 1.73208241e+00        | 1.73207146e+00        | 2.066e-05     | 1.193e-05
	23      | 1.73207146e+00        | 1.73206431e+00        | 1.350e-05     | 7.795e-06
	24      | 1.73206431e+00        | 1.73205963e+00        | 8.824e-06     | 5.094e-06
	25      | 1.73205963e+00        | 1.73205657e+00        | 5.767e-06     | 3.330e-06
	26      | 1.73205657e+00        | 1.73205458e+00        | 3.769e-06     | 2.176e-06
	27      | 1.73205458e+00        | 1.73205327e+00        | 2.464e-06     | 1.422e-06
	28      | 1.73205327e+00        | 1.73205242e+00        | 1.610e-06     | 9.296e-07
	29      | 1.73205242e+00        | 1.73205186e+00        | 1.052e-06     | 6.076e-07
	30      | 1.73205186e+00        | 1.73205150e+00        | 6.878e-07     | 3.971e-07
	31      | 1.73205150e+00        | 1.73205126e+00        | 4.496e-07     | 2.596e-07
	32      | 1.73205126e+00        | 1.73205110e+00        | 2.938e-07     | 1.696e-07
	33      | 1.73205110e+00        | 1.73205100e+00        | 1.920e-07     | 1.109e-07
	34      | 1.73205100e+00        | 1.73205093e+00        | 1.255e-07     | 7.247e-08
	35      | 1.73205093e+00        | 1.73205089e+00        | 8.204e-08     | 4.736e-08
	36      | 1.73205089e+00        | 1.73205086e+00        | 5.362e-08     | 3.096e-08
	37      | 1.73205086e+00        | 1.73205084e+00        | 3.504e-08     | 2.023e-08
	38      | 1.73205084e+00        | 1.73205083e+00        | 2.290e-08     | 1.322e-08
	39      | 1.73205083e+00        | 1.73205082e+00        | 1.497e-08     | 8.643e-09
	40      | 1.73205082e+00        | 1.73205082e+00        | 9.783e-09     | 5.648e-09
	41      | 1.73205082e+00        | 1.73205081e+00        | 6.394e-09     | 3.692e-09
	42      | 1.73205081e+00        | 1.73205081e+00        | 4.179e-09     | 2.413e-09
	43      | 1.73205081e+00        | 1.73205081e+00        | 2.731e-09     | 1.577e-09
	44      | 1.73205081e+00        | 1.73205081e+00        | 1.784e-09     | 1.030e-09
	45      | 1.73205081e+00        | 1.73205081e+00        | 1.166e-09     | 6.731e-10
	46      | 1.73205081e+00        | 1.73205081e+00        | 7.616e-10     | 4.397e-10
	47      | 1.73205081e+00        | 1.73205081e+00        | 4.974e-10     | 2.872e-10
	48      | 1.73205081e+00        | 1.73205081e+00        | 3.247e-10     | 1.875e-10
	49      | 1.73205081e+00        | 1.73205081e+00        | 2.118e-10     | 1.223e-10
	50      | 1.73205081e+00        | 1.73205081e+00        | 1.381e-10     | 7.971e-11
	51      | 1.73205081e+00        | 1.73205081e+00        | 8.985e-11     | 5.187e-11
	52      | 1.73205081e+00        | 1.73205081e+00        | 5.833e-11     | 3.368e-11
	53      | 1.73205081e+00        | 1.73205081e+00        | 3.774e-11     | 2.179e-11
	54      | 1.73205081e+00        | 1.73205081e+00        | 2.428e-11     | 1.402e-11
	55      | 1.73205081e+00        | 1.73205081e+00        | 1.548e-11     | 8.936e-12
	56      | 1.73205081e+00        | 1.73205081e+00        | 9.727e-12     | 5.616e-12
	57      | 1.73205081e+00        | 1.73205081e+00        | 5.969e-12     | 3.446e-12
	58      | 1.73205081e+00        | 1.73205081e+00        | 3.512e-12     | 2.028e-12
	59      | 1.73205081e+00        | 1.73205081e+00        | 1.906e-12     | 1.101e-12
	60      | 1.73205081e+00        | 1.73205081e+00        | 8.571e-13     | 4.948e-13
	61      | 1.73205081e+00        | 1.73205081e+00        | 1.712e-13     | 9.884e-14
	62      | 1.73205081e+00        | 1.73205081e+00        | 2.771e-13     | 1.600e-13
	63      | 1.73205081e+00        | 1.73205081e+00        | 5.700e-13     | 3.291e-13
	64      | 1.73205081e+00        | 1.73205081e+00        | 7.614e-13     | 4.396e-13
	65      | 1.73205081e+00        | 1.73205081e+00        | 8.866e-13     | 5.119e-13
	66      | 1.73205081e+00        | 1.73205081e+00        | 9.683e-13     | 5.591e-13
	67      | 1.73205081e+00        | 1.73205081e+00        | 1.022e-12     | 5.900e-13
	68      | 1.73205081e+00        | 1.73205081e+00        | 1.057e-12     | 6.101e-13
	69      | 1.73205081e+00        | 1.73205081e+00        | 1.080e-12     | 6.233e-13
	70      | 1.73205081e+00        | 1.73205081e+00        | 1.094e-12     | 6.319e-13
	71      | 1.73205081e+00        | 1.73205081e+00        | 1.104e-12     | 6.375e-13
	72      | 1.73205081e+00        | 1.73205081e+00        | 1.111e-12     | 6.412e-13
	73      | 1.73205081e+00        | 1.73205081e+00        | 1.115e-12     | 6.437e-13
	74      | 1.73205081e+00        | 1.73205081e+00        | 1.118e-12     | 6.452e-13
	75      | 1.73205081e+00        | 1.73205081e+00        | 1.119e-12     | 6.462e-13
	76      | 1.73205081e+00        | 1.73205081e+00        | 1.120e-12     | 6.469e-13
	77      | 1.73205081e+00        | 1.73205081e+00        | 1.121e-12     | 6.474e-13
	78      | 1.73205081e+00        | 1.73205081e+00        | 1.122e-12     | 6.477e-13
	79      | 1.73205081e+00        | 1.73205081e+00        | 1.122e-12     | 6.479e-13
	80      | 1.73205081e+00        | 1.73205081e+00        | 1.122e-12     | 6.480e-13
	81      | 1.73205081e+00        | 1.73205081e+00        | 1.123e-12     | 6.482e-13
	82      | 1.73205081e+00        | 1.73205081e+00        | 1.123e-12     | 6.482e-13
	83      | 1.73205081e+00        | 1.73205081e+00        | 1.123e-12     | 6.482e-13
	84      | 1.73205081e+00        | 1.73205081e+00        | 1.123e-12     | 6.482e-13
	85      | 1.73205081e+00        | 1.73205081e+00        | 1.123e-12     | 6.482e-13
	
	
	
	fixed point approximation for f(x) = sin(Pi*x), where g(x) = x + ( f(x)/10 )
	dmaceps =  1.11022302e-16
	Initial value = 0.5
	expected root = 1.00000000
	
	i       | Xn                    | Xn+1                  |  e absolute   | e relative
	--------------------------------------------------------------------------------------------
	1       | 5.00000000e-01        | 6.00000000e-01        | 4.000e-01     | 4.000e-01
	2       | 6.00000000e-01        | 6.95105652e-01        | 3.049e-01     | 3.049e-01
	3       | 6.95105652e-01        | 7.76901534e-01        | 2.231e-01     | 2.231e-01
	4       | 7.76901534e-01        | 8.41390928e-01        | 1.586e-01     | 1.586e-01
	5       | 8.41390928e-01        | 8.89182914e-01        | 1.108e-01     | 1.108e-01
	6       | 8.89182914e-01        | 9.23298114e-01        | 7.670e-02     | 7.670e-02
	7       | 9.23298114e-01        | 9.47162205e-01        | 5.284e-02     | 5.284e-02
	8       | 9.47162205e-01        | 9.63685561e-01        | 3.631e-02     | 3.631e-02
	9       | 9.63685561e-01        | 9.75069347e-01        | 2.493e-02     | 2.493e-02
	10      | 9.75069347e-01        | 9.82893538e-01        | 1.711e-02     | 1.711e-02
	11      | 9.82893538e-01        | 9.88265105e-01        | 1.173e-02     | 1.173e-02
	12      | 9.88265105e-01        | 9.91950896e-01        | 8.049e-03     | 8.049e-03
	13      | 9.91950896e-01        | 9.94479327e-01        | 5.521e-03     | 5.521e-03
	14      | 9.94479327e-01        | 9.96213611e-01        | 3.786e-03     | 3.786e-03
	15      | 9.96213611e-01        | 9.97403112e-01        | 2.597e-03     | 2.597e-03
	16      | 9.97403112e-01        | 9.98218939e-01        | 1.781e-03     | 1.781e-03
	17      | 9.98218939e-01        | 9.98778473e-01        | 1.222e-03     | 1.222e-03
	18      | 9.98778473e-01        | 9.99162226e-01        | 8.378e-04     | 8.378e-04
	19      | 9.99162226e-01        | 9.99425420e-01        | 5.746e-04     | 5.746e-04
	20      | 9.99425420e-01        | 9.99605930e-01        | 3.941e-04     | 3.941e-04
	21      | 9.99605930e-01        | 9.99729731e-01        | 2.703e-04     | 2.703e-04
	22      | 9.99729731e-01        | 9.99814638e-01        | 1.854e-04     | 1.854e-04
	23      | 9.99814638e-01        | 9.99872871e-01        | 1.271e-04     | 1.271e-04
	24      | 9.99872871e-01        | 9.99912810e-01        | 8.719e-05     | 8.719e-05
	25      | 9.99912810e-01        | 9.99940202e-01        | 5.980e-05     | 5.980e-05
	26      | 9.99940202e-01        | 9.99958988e-01        | 4.101e-05     | 4.101e-05
	27      | 9.99958988e-01        | 9.99971872e-01        | 2.813e-05     | 2.813e-05
	28      | 9.99971872e-01        | 9.99980709e-01        | 1.929e-05     | 1.929e-05
	29      | 9.99980709e-01        | 9.99986769e-01        | 1.323e-05     | 1.323e-05
	30      | 9.99986769e-01        | 9.99990926e-01        | 9.074e-06     | 9.074e-06
	31      | 9.99990926e-01        | 9.99993777e-01        | 6.223e-06     | 6.223e-06
	32      | 9.99993777e-01        | 9.99995732e-01        | 4.268e-06     | 4.268e-06
	33      | 9.99995732e-01        | 9.99997073e-01        | 2.927e-06     | 2.927e-06
	34      | 9.99997073e-01        | 9.99997992e-01        | 2.008e-06     | 2.008e-06
	35      | 9.99997992e-01        | 9.99998623e-01        | 1.377e-06     | 1.377e-06
	36      | 9.99998623e-01        | 9.99999056e-01        | 9.444e-07     | 9.444e-07
	37      | 9.99999056e-01        | 9.99999352e-01        | 6.477e-07     | 6.477e-07
	38      | 9.99999352e-01        | 9.99999556e-01        | 4.442e-07     | 4.442e-07
	39      | 9.99999556e-01        | 9.99999695e-01        | 3.047e-07     | 3.047e-07
	40      | 9.99999695e-01        | 9.99999791e-01        | 2.089e-07     | 2.089e-07
	41      | 9.99999791e-01        | 9.99999857e-01        | 1.433e-07     | 1.433e-07
	42      | 9.99999857e-01        | 9.99999902e-01        | 9.828e-08     | 9.828e-08
	43      | 9.99999902e-01        | 9.99999933e-01        | 6.741e-08     | 6.741e-08
	44      | 9.99999933e-01        | 9.99999954e-01        | 4.623e-08     | 4.623e-08
	45      | 9.99999954e-01        | 9.99999968e-01        | 3.171e-08     | 3.171e-08
	46      | 9.99999968e-01        | 9.99999978e-01        | 2.175e-08     | 2.175e-08
	47      | 9.99999978e-01        | 9.99999985e-01        | 1.491e-08     | 1.491e-08
	48      | 9.99999985e-01        | 9.99999990e-01        | 1.023e-08     | 1.023e-08
	49      | 9.99999990e-01        | 9.99999993e-01        | 7.015e-09     | 7.015e-09
	50      | 9.99999993e-01        | 9.99999995e-01        | 4.811e-09     | 4.811e-09
	51      | 9.99999995e-01        | 9.99999997e-01        | 3.300e-09     | 3.300e-09
	52      | 9.99999997e-01        | 9.99999998e-01        | 2.263e-09     | 2.263e-09
	53      | 9.99999998e-01        | 9.99999998e-01        | 1.552e-09     | 1.552e-09
	54      | 9.99999998e-01        | 9.99999999e-01        | 1.065e-09     | 1.065e-09
	55      | 9.99999999e-01        | 9.99999999e-01        | 7.301e-10     | 7.301e-10
	56      | 9.99999999e-01        | 9.99999999e-01        | 5.007e-10     | 5.007e-10
	57      | 9.99999999e-01        | 1.00000000e+00        | 3.434e-10     | 3.434e-10
	58      | 1.00000000e+00        | 1.00000000e+00        | 2.355e-10     | 2.355e-10
	59      | 1.00000000e+00        | 1.00000000e+00        | 1.615e-10     | 1.615e-10
	60      | 1.00000000e+00        | 1.00000000e+00        | 1.108e-10     | 1.108e-10
	61      | 1.00000000e+00        | 1.00000000e+00        | 7.598e-11     | 7.598e-11
	62      | 1.00000000e+00        | 1.00000000e+00        | 5.211e-11     | 5.211e-11
	63      | 1.00000000e+00        | 1.00000000e+00        | 3.574e-11     | 3.574e-11
	64      | 1.00000000e+00        | 1.00000000e+00        | 2.451e-11     | 2.451e-11
	65      | 1.00000000e+00        | 1.00000000e+00        | 1.681e-11     | 1.681e-11
	66      | 1.00000000e+00        | 1.00000000e+00        | 1.153e-11     | 1.153e-11
	67      | 1.00000000e+00        | 1.00000000e+00        | 7.908e-12     | 7.908e-12
	68      | 1.00000000e+00        | 1.00000000e+00        | 5.424e-12     | 5.424e-12
	69      | 1.00000000e+00        | 1.00000000e+00        | 3.720e-12     | 3.720e-12
	70      | 1.00000000e+00        | 1.00000000e+00        | 2.551e-12     | 2.551e-12
	71      | 1.00000000e+00        | 1.00000000e+00        | 1.750e-12     | 1.750e-12
	72      | 1.00000000e+00        | 1.00000000e+00        | 1.200e-12     | 1.200e-12
	73      | 1.00000000e+00        | 1.00000000e+00        | 8.230e-13     | 8.230e-13
	74      | 1.00000000e+00        | 1.00000000e+00        | 5.644e-13     | 5.644e-13
	75      | 1.00000000e+00        | 1.00000000e+00        | 3.871e-13     | 3.871e-13
	76      | 1.00000000e+00        | 1.00000000e+00        | 2.655e-13     | 2.655e-13
	77      | 1.00000000e+00        | 1.00000000e+00        | 1.821e-13     | 1.821e-13
	78      | 1.00000000e+00        | 1.00000000e+00        | 1.249e-13     | 1.249e-13
	79      | 1.00000000e+00        | 1.00000000e+00        | 8.560e-14     | 8.560e-14
	80      | 1.00000000e+00        | 1.00000000e+00        | 5.862e-14     | 5.862e-14
	81      | 1.00000000e+00        | 1.00000000e+00        | 4.019e-14     | 4.019e-14
	82      | 1.00000000e+00        | 1.00000000e+00        | 2.753e-14     | 2.753e-14
	83      | 1.00000000e+00        | 1.00000000e+00        | 1.887e-14     | 1.887e-14
	84      | 1.00000000e+00        | 1.00000000e+00        | 1.288e-14     | 1.288e-14
	85      | 1.00000000e+00        | 1.00000000e+00        | 8.771e-15     | 8.771e-15
	86      | 1.00000000e+00        | 1.00000000e+00        | 5.995e-15     | 5.995e-15
	87      | 1.00000000e+00        | 1.00000000e+00        | 4.108e-15     | 4.108e-15
	88      | 1.00000000e+00        | 1.00000000e+00        | 2.776e-15     | 2.776e-15
	89      | 1.00000000e+00        | 1.00000000e+00        | 1.887e-15     | 1.887e-15
	90      | 1.00000000e+00        | 1.00000000e+00        | 1.332e-15     | 1.332e-15
	91      | 1.00000000e+00        | 1.00000000e+00        | 8.882e-16     | 8.882e-16
	92      | 1.00000000e+00        | 1.00000000e+00        | 5.551e-16     | 5.551e-16
	93      | 1.00000000e+00        | 1.00000000e+00        | 3.331e-16     | 3.331e-16
	94      | 1.00000000e+00        | 1.00000000e+00        | 2.220e-16     | 2.220e-16
	95      | 1.00000000e+00        | 1.00000000e+00        | 1.110e-16     | 1.110e-16

The result in both cases is convergence to an approximation of a root for the defined functions f(x).

**Implementation/Code:** The following is the code for fixed1()

	double fixed1(double(*f)(double), double xn, double tol, int maxItr, double exproot) {

		int i = 0;
		double fxn1 = 0.0;
		double eabsolute = 0.0;
		double erelative = 0.0;

		printf("fixed point approximation for f(x) = sin(Pi*x), where g(x) = x + ( f(x)/10 )\n");
		printf("dmaceps =  %.8e\n", tol);
		printf("Initial value = %.1lf\n", xn);
		printf("expected root = %.8lf\n\n", exproot);
		printf("i\t| Xn\t\t\t| Xn+1\t\t\t|  e absolute\t| e relative\n");
		printf("--------------------------------------------------------------------------------------------\n");

		eabsolute = 10.0 * tol;

		while ((eabsolute > tol) && (maxItr > 0)) {

			maxItr--;
			i++;

			fxn1 = xn + f(xn);
			eabsolute = eabs(fxn1, exproot);
			erelative = erel(fxn1, exproot);

			printf("%d\t| %.8e\t| %.8e\t| %.3e\t| %.3e\n", i, xn, fxn1, eabsolute, erelative);

			xn = fxn1;
		}

		printf("\n\n\n");

		return fxn1;
	}

**Implementation/Code:** The following is the code for fixed2()

	double fixed2(double(*f)(double), double xn, double tol, int maxItr, double exproot) {

		int i = 0;
		double fxn1 = 0.0;
		double eabsolute = 0.0;
		double erelative = 0.0;

		printf("fixed point approximation for f(x) = ( x^2 - 3 ), where g(x) = x - ( f(x)/10 )\n");
		printf("dmaceps =  %.8e\n", tol);
		printf("Initial value = %lf\n", xn);
		printf("expected root = %.8lf\n\n", exproot);
		printf("i\t| Xn\t\t\t| Xn+1\t\t\t| e absolute\t| e relative\n");
		printf("--------------------------------------------------------------------------------------------\n");

		eabsolute = 10.0 * tol;

		while ((eabsolute > tol) && (maxItr > 0)) {

			maxItr--;
			i++;

			fxn1 = xn - f(xn);

			eabsolute = eabs(fxn1, exproot);
			erelative = erel(fxn1, exproot);

			printf("%d\t| %.8e\t| %.8e\t| %.3e\t| %.3e\n", i, xn, fxn1, eabsolute, erelative);

			xn = fxn1;
		}

		printf("\n\n\n");

		return fxn1;
	}

**Last Modified:** September/2018
