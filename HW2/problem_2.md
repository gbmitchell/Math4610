# Math 4610 Fundamentals of Computational Mathematics
Homework 2 problem 2.

**Routine Name:**           derivative

**Author:** Gary Mitchell

**Language:** C. The code can be compiled using the Microsoft Visual C compiler.

For example,

    approximation.c

will produce an executable **approximation.exe** that can be executed.

**Description/Purpose:** This function will compute an approximation for the derivative of a defined
function f(x) at a given value of x.

**Input:** There are no inputs needed in this case. Arguments are passed by reference and the function will change their values.
The real purpose is to produce values in those variables to be used as needed.

**Output:** This function returns a single precision value for the number of decimal digits that can be represented on the
computer being queried.

**Usage/Example:**

The function has two arguments needed to produce the values of the precision in terms of the smallest number that can be
represented. Since the code is written in terms of a C function, the value of the machine epsilon (seps) is a single
precision value (float) and the power of two that gives the machine epsilon (ipow) is an integer. 

    #include <stdio.h>
    #include <math.h>
    #include <mylib.h>
    
    int main() {
        double Pi = 3.1415926535897932384626433832795028841971693993751058209749445923;
        int i = 0, j = 0, maxIteration = 0;
        int ipow = 0;
        double eps = 0.0;
        double x = 0.0;
        double h = 0.0;
        double fxx = 0.0;
        double expder = 0.0;
        double eabsolute = 0.0;
        double erelative = 0.0;
    
        //***************************************************************************************
        //*******************  approximation d/dx(x^2 + 3) at x = 2.0  **************************
        //***************************************************************************************
        x = 2.0;
        h = 1.0;
        maxIteration = 55;
        expder = 4.0;
        dmaceps(&eps, &ipow);
        eabsolute = 1.0;
    
        printf("dmaceps =  %.8e\n", eps);
        printf("x = %lf\n", x);
        printf("d/dx(x^2 + 3) = %.12lf\n\n", expder);
    
        printf("i\t| appoximate derivative\t\t| h\t\t| e absolute\t| e relative\n");
        printf("--------------------------------------------------------------------------------------------\n");
    
        while ( (eabsolute > eps) && maxIteration > 0 ) {
    
            maxIteration--;
            i++;
    
            fxx = derivative(fnct1, x, h);
    
            eabsolute = eabs(fxx, expder);
            erelative = erel(fxx, expder);
    
            printf("%d\t| %.8e\t\t| %.3e\t| %.3e\t| %.3e\n", i, fxx, h, eabsolute, erelative);
            h = h / 2.0;
    
        }
        printf("\n\n\n");
    
        //***************************************************************************************
        //*******************  approximation for d/dx(e^x) at x = 2.0  **************************
        //***************************************************************************************
    
        expder = 7.38905609893;
        eabsolute = 1.0;
        x = 2.0;
        h = 1.0;
        i = 0;
        maxIteration = 55;
    
        dmaceps(&eps, &ipow);
    
        printf("dmaceps =  %.8e\n", eps);
        printf("x = %lf\n", x);
        printf("d/dx(e^x) = %.12lf\n\n", expder);
    
        printf("i\t| appoximate derivative\t\t| h\t\t| e absolute\t| e relative\n");
        printf("--------------------------------------------------------------------------------------------\n");
    
        while ( (eabsolute > eps) && maxIteration > 0 ) {
    
            maxIteration--;
            i++;
    
            fxx = derivative(exp, x, h);
    
            eabsolute = eabs(fxx, expder);
            erelative = erel(fxx, expder);
    
            printf("%d\t| %.8e\t\t| %.3e\t| %.3e\t| %.3e\n", i, fxx, h, eabsolute, erelative);
            h = h / 2.0;
    
        }
    
Output from the lines above:

    dmaceps =  1.11022302e-16
    x = 2.000000
    d/dx(x^2 + 3) = 4.000000000000

    i       | appoximate derivative         | h             | e absolute    | e relative
    --------------------------------------------------------------------------------------------
    1       | 5.00000000e+00                | 1.000e+00     | 1.000e+00     | 2.500e-01
    2       | 4.50000000e+00                | 5.000e-01     | 5.000e-01     | 1.250e-01
    3       | 4.25000000e+00                | 2.500e-01     | 2.500e-01     | 6.250e-02
    4       | 4.12500000e+00                | 1.250e-01     | 1.250e-01     | 3.125e-02
    5       | 4.06250000e+00                | 6.250e-02     | 6.250e-02     | 1.563e-02
    6       | 4.03125000e+00                | 3.125e-02     | 3.125e-02     | 7.813e-03
    7       | 4.01562500e+00                | 1.563e-02     | 1.563e-02     | 3.906e-03
    8       | 4.00781250e+00                | 7.813e-03     | 7.813e-03     | 1.953e-03
    9       | 4.00390625e+00                | 3.906e-03     | 3.906e-03     | 9.766e-04
    10      | 4.00195313e+00                | 1.953e-03     | 1.953e-03     | 4.883e-04
    11      | 4.00097656e+00                | 9.766e-04     | 9.766e-04     | 2.441e-04
    12      | 4.00048828e+00                | 4.883e-04     | 4.883e-04     | 1.221e-04
    13      | 4.00024414e+00                | 2.441e-04     | 2.441e-04     | 6.104e-05
    14      | 4.00012207e+00                | 1.221e-04     | 1.221e-04     | 3.052e-05
    15      | 4.00006104e+00                | 6.104e-05     | 6.104e-05     | 1.526e-05
    16      | 4.00003052e+00                | 3.052e-05     | 3.052e-05     | 7.629e-06
    17      | 4.00001526e+00                | 1.526e-05     | 1.526e-05     | 3.815e-06
    18      | 4.00000763e+00                | 7.629e-06     | 7.629e-06     | 1.907e-06
    19      | 4.00000381e+00                | 3.815e-06     | 3.815e-06     | 9.537e-07
    20      | 4.00000191e+00                | 1.907e-06     | 1.907e-06     | 4.768e-07
    21      | 4.00000095e+00                | 9.537e-07     | 9.537e-07     | 2.384e-07
    22      | 4.00000048e+00                | 4.768e-07     | 4.768e-07     | 1.192e-07
    23      | 4.00000024e+00                | 2.384e-07     | 2.384e-07     | 5.960e-08
    24      | 4.00000012e+00                | 1.192e-07     | 1.192e-07     | 2.980e-08
    25      | 4.00000006e+00                | 5.960e-08     | 5.960e-08     | 1.490e-08
    26      | 4.00000003e+00                | 2.980e-08     | 2.980e-08     | 7.451e-09
    27      | 4.00000000e+00                | 1.490e-08     | 0.000e+00     | 0.000e+00



    dmaceps =  1.11022302e-16
    x = 2.000000
    d/dx(e^x) = 7.389056098930

    i       | appoximate derivative         | h             | e absolute    | e relative
    --------------------------------------------------------------------------------------------
    1       | 1.26964808e+01                | 1.000e+00     | 5.307e+00     | 7.183e-01
    2       | 9.58687572e+00                | 5.000e-01     | 2.198e+00     | 2.974e-01
    3       | 8.39471895e+00                | 2.500e-01     | 1.006e+00     | 1.361e-01
    4       | 7.87073111e+00                | 1.250e-01     | 4.817e-01     | 6.519e-02
    5       | 7.62485080e+00                | 6.250e-02     | 2.358e-01     | 3.191e-02
    6       | 7.50572220e+00                | 3.125e-02     | 1.167e-01     | 1.579e-02
    7       | 7.44708494e+00                | 1.563e-02     | 5.803e-02     | 7.853e-03
    8       | 7.41799491e+00                | 7.813e-03     | 2.894e-02     | 3.916e-03
    9       | 7.40350666e+00                | 3.906e-03     | 1.445e-02     | 1.956e-03
    10      | 7.39627667e+00                | 1.953e-03     | 7.221e-03     | 9.772e-04
    11      | 7.39266521e+00                | 9.766e-04     | 3.609e-03     | 4.884e-04
    12      | 7.39086036e+00                | 4.883e-04     | 1.804e-03     | 2.442e-04
    13      | 7.38995816e+00                | 2.441e-04     | 9.021e-04     | 1.221e-04
    14      | 7.38950711e+00                | 1.221e-04     | 4.510e-04     | 6.104e-05
    15      | 7.38928160e+00                | 6.104e-05     | 2.255e-04     | 3.052e-05
    16      | 7.38916885e+00                | 3.052e-05     | 1.127e-04     | 1.526e-05
    17      | 7.38911247e+00                | 1.526e-05     | 5.637e-05     | 7.629e-06
    18      | 7.38908429e+00                | 7.629e-06     | 2.819e-05     | 3.815e-06
    19      | 7.38907019e+00                | 3.815e-06     | 1.409e-05     | 1.907e-06
    20      | 7.38906315e+00                | 1.907e-06     | 7.047e-06     | 9.536e-07
    21      | 7.38905962e+00                | 9.537e-07     | 3.523e-06     | 4.768e-07
    22      | 7.38905786e+00                | 4.768e-07     | 1.761e-06     | 2.383e-07
    23      | 7.38905698e+00                | 2.384e-07     | 8.817e-07     | 1.193e-07
    24      | 7.38905654e+00                | 1.192e-07     | 4.421e-07     | 5.983e-08
    25      | 7.38905631e+00                | 5.960e-08     | 2.111e-07     | 2.857e-08
    26      | 7.38905621e+00                | 2.980e-08     | 1.068e-07     | 1.446e-08
    27      | 7.38905615e+00                | 1.490e-08     | 4.721e-08     | 6.390e-09
    28      | 7.38905609e+00                | 7.451e-09     | 1.239e-08     | 1.677e-09
    29      | 7.38905597e+00                | 3.725e-09     | 1.316e-07     | 1.781e-08
    30      | 7.38905621e+00                | 1.863e-09     | 1.068e-07     | 1.446e-08
    31      | 7.38905621e+00                | 9.313e-10     | 1.068e-07     | 1.446e-08
    32      | 7.38905525e+00                | 4.657e-10     | 8.469e-07     | 1.146e-07
    33      | 7.38905716e+00                | 2.328e-10     | 1.060e-06     | 1.435e-07
    34      | 7.38905334e+00                | 1.164e-10     | 2.754e-06     | 3.727e-07
    35      | 7.38905334e+00                | 5.821e-11     | 2.754e-06     | 3.727e-07
    36      | 7.38903809e+00                | 2.910e-11     | 1.801e-05     | 2.438e-06
    37      | 7.38903809e+00                | 1.455e-11     | 1.801e-05     | 2.438e-06
    38      | 7.38903809e+00                | 7.276e-12     | 1.801e-05     | 2.438e-06
    39      | 7.38891602e+00                | 3.638e-12     | 1.401e-04     | 1.896e-05
    40      | 7.38916016e+00                | 1.819e-12     | 1.041e-04     | 1.408e-05
    41      | 7.38867188e+00                | 9.095e-13     | 3.842e-04     | 5.200e-05
    42      | 7.38867188e+00                | 4.547e-13     | 3.842e-04     | 5.200e-05
    43      | 7.38671875e+00                | 2.274e-13     | 2.337e-03     | 3.163e-04
    44      | 7.39062500e+00                | 1.137e-13     | 1.569e-03     | 2.123e-04
    45      | 7.39062500e+00                | 5.684e-14     | 1.569e-03     | 2.123e-04
    46      | 7.37500000e+00                | 2.842e-14     | 1.406e-02     | 1.902e-03
    47      | 7.37500000e+00                | 1.421e-14     | 1.406e-02     | 1.902e-03
    48      | 7.37500000e+00                | 7.105e-15     | 1.406e-02     | 1.902e-03
    49      | 7.25000000e+00                | 3.553e-15     | 1.391e-01     | 1.882e-02
    50      | 7.50000000e+00                | 1.776e-15     | 1.109e-01     | 1.501e-02
    51      | 7.00000000e+00                | 8.882e-16     | 3.891e-01     | 5.265e-02
    52      | 6.00000000e+00                | 4.441e-16     | 1.389e+00     | 1.880e-01
    53      | 0.00000000e+00                | 2.220e-16     | 7.389e+00     | 1.000e+00
    54      | 0.00000000e+00                | 1.110e-16     | 7.389e+00     | 1.000e+00
    55      | 0.00000000e+00                | 5.551e-17     | 7.389e+00     | 1.000e+00



    dmaceps =  1.11022302e-16
    x = 2.000000
    d/dx( sqrt(x) ) = 0.353553390593

    i       | appoximate derivative         | h             | e absolute    | e relative
    --------------------------------------------------------------------------------------------
    1       | 3.17837245e-01                | 1.000e+00     | 3.572e-02     | 1.010e-01
    2       | 3.33850535e-01                | 5.000e-01     | 1.970e-02     | 5.573e-02
    3       | 3.43145751e-01                | 2.500e-01     | 1.041e-02     | 2.944e-02
    4       | 3.48195291e-01                | 1.250e-01     | 5.358e-03     | 1.515e-02
    5       | 3.50833588e-01                | 6.250e-02     | 2.720e-03     | 7.693e-03
    6       | 3.52183008e-01                | 3.125e-02     | 1.370e-03     | 3.876e-03
    7       | 3.52865541e-01                | 1.563e-02     | 6.878e-04     | 1.946e-03
    8       | 3.53208796e-01                | 7.813e-03     | 3.446e-04     | 9.747e-04
    9       | 3.53380925e-01                | 3.906e-03     | 1.725e-04     | 4.878e-04
    10      | 3.53467116e-01                | 1.953e-03     | 8.627e-05     | 2.440e-04
    11      | 3.53510243e-01                | 9.766e-04     | 4.315e-05     | 1.220e-04
    12      | 3.53531814e-01                | 4.883e-04     | 2.158e-05     | 6.103e-05
    13      | 3.53542602e-01                | 2.441e-04     | 1.079e-05     | 3.052e-05
    14      | 3.53547996e-01                | 1.221e-04     | 5.395e-06     | 1.526e-05
    15      | 3.53550693e-01                | 6.104e-05     | 2.697e-06     | 7.629e-06
    16      | 3.53552042e-01                | 3.052e-05     | 1.349e-06     | 3.815e-06
    17      | 3.53552716e-01                | 1.526e-05     | 6.743e-07     | 1.907e-06
    18      | 3.53553053e-01                | 7.629e-06     | 3.372e-07     | 9.537e-07
    19      | 3.53553222e-01                | 3.815e-06     | 1.686e-07     | 4.769e-07
    20      | 3.53553306e-01                | 1.907e-06     | 8.440e-08     | 2.387e-07
    21      | 3.53553348e-01                | 9.537e-07     | 4.214e-08     | 1.192e-07
    22      | 3.53553369e-01                | 4.768e-07     | 2.142e-08     | 6.058e-08
    23      | 3.53553380e-01                | 2.384e-07     | 1.071e-08     | 3.028e-08
    24      | 3.53553385e-01                | 1.192e-07     | 6.051e-09     | 1.711e-08
    25      | 3.53553385e-01                | 5.960e-08     | 6.051e-09     | 1.711e-08
    26      | 3.53553385e-01                | 2.980e-08     | 6.051e-09     | 1.711e-08
    27      | 3.53553385e-01                | 1.490e-08     | 6.051e-09     | 1.711e-08
    28      | 3.53553385e-01                | 7.451e-09     | 6.051e-09     | 1.711e-08
    29      | 3.53553355e-01                | 3.725e-09     | 3.585e-08     | 1.014e-07
    30      | 3.53553295e-01                | 1.863e-09     | 9.546e-08     | 2.700e-07
    31      | 3.53553295e-01                | 9.313e-10     | 9.546e-08     | 2.700e-07
    32      | 3.53553295e-01                | 4.657e-10     | 9.546e-08     | 2.700e-07
    33      | 3.53552818e-01                | 2.328e-10     | 5.723e-07     | 1.619e-06
    34      | 3.53551865e-01                | 1.164e-10     | 1.526e-06     | 4.316e-06
    35      | 3.53549957e-01                | 5.821e-11     | 3.433e-06     | 9.711e-06
    36      | 3.53553772e-01                | 2.910e-11     | 3.814e-07     | 1.079e-06
    37      | 3.53546143e-01                | 1.455e-11     | 7.248e-06     | 2.050e-05
    38      | 3.53546143e-01                | 7.276e-12     | 7.248e-06     | 2.050e-05
    39      | 3.53515625e-01                | 3.638e-12     | 3.777e-05     | 1.068e-04
    40      | 3.53515625e-01                | 1.819e-12     | 3.777e-05     | 1.068e-04
    41      | 3.53515625e-01                | 9.095e-13     | 3.777e-05     | 1.068e-04
    42      | 3.53515625e-01                | 4.547e-13     | 3.777e-05     | 1.068e-04
    43      | 3.53515625e-01                | 2.274e-13     | 3.777e-05     | 1.068e-04
    44      | 3.53515625e-01                | 1.137e-13     | 3.777e-05     | 1.068e-04
    45      | 3.51562500e-01                | 5.684e-14     | 1.991e-03     | 5.631e-03
    46      | 3.51562500e-01                | 2.842e-14     | 1.991e-03     | 5.631e-03
    47      | 3.43750000e-01                | 1.421e-14     | 9.803e-03     | 2.773e-02
    48      | 3.43750000e-01                | 7.105e-15     | 9.803e-03     | 2.773e-02
    49      | 3.12500000e-01                | 3.553e-15     | 4.105e-02     | 1.161e-01
    50      | 2.50000000e-01                | 1.776e-15     | 1.036e-01     | 2.929e-01

The first value (24) is the number of binary digits that define the machine epsilon and the second is related to the
decimal version of the same value. The number of decimal digits that can be represented is roughly eight (e-08 on the
end of the second value).

**Implementation/Code:** The following is the code for smaceps()

    double derivative(double(*f)(double), double x, double h) {
        double fxx = 0.0;
        fxx = (f(x + h) - f(x)) / (h);
        return fxx;
    }

**Last Modified:** September/2018
